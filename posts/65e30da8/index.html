<!-- build time:Fri Mar 29 2024 20:39:28 GMT+0800 (China Standard Time) --><!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" type="application/rss+xml" title="UniStart's Blog" href="https://unistart2.github.io/rss.xml"><link rel="alternate" type="application/atom+xml" title="UniStart's Blog" href="https://unistart2.github.io/atom.xml"><link rel="alternate" type="application/json" title="UniStart's Blog" href="https://unistart2.github.io/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/css/app.css?v=0.2.5"><meta name="keywords" content="Rust"><link rel="canonical" href="https://unistart2.github.io/posts/65e30da8/"><title>Rust 学习 - 基本语法 - Rust | UniStart = UniStart's Blog = 心在哪里，家在哪里</title><meta name="generator" content="Hexo 6.2.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">Rust 学习 - 基本语法</h1><div class="meta"><span class="item" title="创建时间：2022-08-26 17:54:24"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">发表于</span> <time itemprop="dateCreated datePublished" datetime="2022-08-26T17:54:24+08:00">2022-08-26</time> </span><span class="item" title="本文字数"><span class="icon"><i class="ic i-pen"></i> </span><span class="text">本文字数</span> <span>5.7k</span> <span class="text">字</span> </span><span class="item" title="阅读时长"><span class="icon"><i class="ic i-clock"></i> </span><span class="text">阅读时长</span> <span>5 分钟</span></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="切换导航栏"><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">UniStart</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><ul><li class="item" data-background-image="https://api.hanximeng.com/ranimg/api.php?653076"></li><li class="item" data-background-image="https://api.hanximeng.com/ranimg/api.php?597957"></li><li class="item" data-background-image="https://api.hanximeng.com/ranimg/api.php?69017"></li><li class="item" data-background-image="https://api.hanximeng.com/ranimg/api.php?906776"></li><li class="item" data-background-image="https://api.hanximeng.com/ranimg/api.php?953193"></li><li class="item" data-background-image="https://api.hanximeng.com/ranimg/api.php?797095"></li></ul></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">首页</a></span><i class="ic i-angle-right"></i> <span class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/Rust/" itemprop="item" rel="index" title="分类于 Rust"><span itemprop="name">Rust</span></a><meta itemprop="position" content="1"></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://unistart2.github.io/posts/65e30da8/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="unistart"><meta itemprop="description" content="心在哪里，家在哪里, 个人博客"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="UniStart's Blog"></span><div class="body md" itemprop="articleBody"><link rel="stylesheet" type="text&#x2F;css" href="https://cdn.jsdelivr.net/npm/hexo-tag-hint@0.3.1/dist/hexo-tag-hint.min.css"><blockquote><p>搭建 Rust 环境<br>1、安装 Rust<br>使用<span class="exturl" data-url="aHR0cHM6Ly9ydXN0dXAucnMv"> rustup.rs</span> 中给出的方法，根据自身操作系统进行安装即可</p><p>2、 选择开发工具<br>选择一：Clion + 插件形式<br>推荐插件:<br>Rust: 提供 Rust 语言相支持</p><p>选择二：vscode + 插件形式<br>推荐插件:<br>rust-analyzer: 实时编译和分析 Rust 代码，提示代码中的错误，并对类型进行标注<br>rust syntax: 为代码提供语法高亮<br>crates: 帮助分析当前项目的依赖是否是最新版本<br>Even Better TOML: Rust 使用 toml 做项目的配置管理，提供 toml 语法高亮及检查 toml 文件中的错误<br>rust test lens: 可以帮你快速运行某个 Rust 测试</p></blockquote><h2 id="变量和函数"><a class="anchor" href="#变量和函数">#</a> 变量和函数</h2><blockquote><p>Rust 支持类型推导<br>在编译器能够推导类型的情况下，可以省略变量类型，但是<strong>常量和静态变量必须声明变量类型</strong></p></blockquote><figure class="highlight rust"><figcaption data-lang="rust"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">let</span> var1 <span class="token operator">=</span> <span class="token string">"var1"</span><span class="token punctuation">;</span> <span class="token comment">// 没有显示指定变量的类型，编译器会自行进行推导</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre>  <span class="token keyword">const</span> <span class="token constant">CONST_VAL</span><span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">str</span> <span class="token operator">=</span> <span class="token string">"const value"</span><span class="token punctuation">;</span> <span class="token comment">// 常量必须声明变量类型</span></pre></td></tr><tr><td data-num="4"></td><td><pre>  <span class="token keyword">static</span> <span class="token constant">STATIC_VAL</span><span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">str</span> <span class="token operator">=</span> <span class="token string">"static value"</span><span class="token punctuation">;</span> <span class="token comment">// 静态变量也必须声明变量类型</span></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre>  <span class="token comment">// 常量和静态变量不进行类型声明会报类型丢失的错误</span></pre></td></tr><tr><td data-num="7"></td><td><pre>  <span class="token comment">// const NOT_DECLEAR: = ""; // Missing type for `const` item</span></pre></td></tr></table></figure><blockquote><p>Rust 变量默认是不可变的<br>可以添加 mut 关键字让变量具备可变性。<br>当你使用 mut 却没有修改变量，Rust 编译器会友好地提示你移除不必要的 mut。</p></blockquote><figure class="highlight rust"><figcaption data-lang="rust"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">let</span> immutable_name <span class="token operator">=</span> <span class="token string">"alice"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    <span class="token comment">// immutable_name = "bob"; // Cannot assign twice to immutable variable [E0384]</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    </pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token keyword">let</span> <span class="token keyword">mut</span> mutable_name <span class="token operator">=</span> <span class="token string">"andy"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    mutable_name <span class="token operator">=</span> <span class="token string">"bob"</span><span class="token punctuation">;</span></pre></td></tr></table></figure><blockquote><p>Rust 变量命名<br>Rust 变量支持英文、数字和下划线 (_)，且只能以下划线和英文开头<br><strong>以下划线开头的变量，表示暂时未被使用的变量</strong><br>Rust 也支持使用非 ASCII 字符进行变量命名</p><p>Rust 中的函数<br>在 Rust 下，函数是一等公民，可以作为参数或返回值</p></blockquote><figure class="highlight rust"><figcaption data-lang="rust"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">//apply 函数有两个参数：一个是 value 类型是 i32，</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment">// 另一个是 func 类型是 fn (i32) -> i32，它表明 func 参数接受一个函数作为参数，</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">// 这个传入参数必须满足：参数只有一个，且类型为 i32，返回值类型也是 i32</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">fn</span> <span class="token function-definition function">apply</span><span class="token punctuation">(</span>value<span class="token punctuation">:</span> <span class="token keyword">i32</span><span class="token punctuation">,</span> func<span class="token punctuation">:</span> <span class="token keyword">fn</span><span class="token punctuation">(</span><span class="token keyword">i32</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token keyword">i32</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token keyword">i32</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>  <span class="token function">func</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span> </pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="7"></td><td><pre></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">fn</span> <span class="token function-definition function">square</span><span class="token punctuation">(</span>value<span class="token punctuation">:</span> <span class="token keyword">i32</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token keyword">i32</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>  value <span class="token operator">*</span> value</pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token keyword">fn</span> <span class="token function-definition function">cube</span><span class="token punctuation">(</span>value<span class="token punctuation">:</span> <span class="token keyword">i32</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token keyword">i32</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>  value <span class="token operator">*</span> value <span class="token operator">*</span> value</pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="15"></td><td><pre></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token keyword">fn</span> <span class="token function-definition function">main</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>  <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"apply square: &#123;&#125;"</span><span class="token punctuation">,</span> <span class="token function">apply</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> square<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// apply square: 4</span></pre></td></tr><tr><td data-num="18"></td><td><pre>  <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"apply square: &#123;&#125;"</span><span class="token punctuation">,</span> <span class="token function">apply</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> cube<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// apply cube: 8</span></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><blockquote><p>Rust 参数和返回值<br>Rust 函数参数的类型和返回值的类型都必须显式定义，如果没有返回值可以省略，返回 unit 类型<br>函数内部如果提前返回，需要用 return 关键字，否则最后一个表达式就是其返回值<br>如果最后一个表达式后添加了；分号，隐含其返回值为 unit 类型</p></blockquote><figure class="highlight rust"><figcaption data-lang="rust"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span></span><span class="token keyword">f64</span><span class="token punctuation">::</span><span class="token namespace">consts<span class="token punctuation">::</span></span><span class="token constant">PI</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">fn</span> <span class="token function-definition function">pi</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token keyword">f64</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token constant">PI</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">fn</span> <span class="token function-definition function">not_pi</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token constant">PI</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="10"></td><td><pre></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token keyword">let</span> is_pi <span class="token operator">=</span> <span class="token function">pi</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    <span class="token keyword">let</span> is_unit1 <span class="token operator">=</span> <span class="token function">not_pi</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    <span class="token keyword">let</span> is_unit2 <span class="token operator">=</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>        <span class="token function">pi</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"is_pi: &#123;:?&#125;, is_unit1: &#123;:?&#125;, is_unit2: &#123;:?&#125;"</span><span class="token punctuation">,</span> is_pi<span class="token punctuation">,</span> is_unit1<span class="token punctuation">,</span> is_unit2<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h2 id="数据结构"><a class="anchor" href="#数据结构">#</a> 数据结构</h2><blockquote><p>用 struct 定义结构体，用 enum 定义标签联合（tagged union)，<br>还可以像 Python 一样随手定义元组 (tuple) 类型。</p></blockquote><figure class="highlight rust"><figcaption data-lang="rust"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token attribute attr-name">#[derive(Debug)]</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">enum</span> <span class="token type-definition class-name">Gender</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token class-name">Unspecified</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token class-name">Female</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token class-name">Male</span> <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="7"></td><td><pre></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token attribute attr-name">#[derive(Debug, Copy, Clone)]</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token keyword">struct</span> <span class="token type-definition class-name">UserId</span><span class="token punctuation">(</span><span class="token keyword">u64</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token attribute attr-name">#[derive(Debug, Copy, Clone)]</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token keyword">struct</span> <span class="token type-definition class-name">TopicId</span><span class="token punctuation">(</span><span class="token keyword">u64</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token attribute attr-name">#[derive(Debug)]</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">struct</span> <span class="token type-definition class-name">User</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    id<span class="token punctuation">:</span> <span class="token class-name">UserId</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    name<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    gender<span class="token punctuation">:</span> <span class="token class-name">Gender</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="20"></td><td><pre></pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token attribute attr-name">#[derive(Debug)]</span></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token keyword">struct</span> <span class="token type-definition class-name">Topic</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="23"></td><td><pre>    id<span class="token punctuation">:</span> <span class="token class-name">TopicId</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="24"></td><td><pre>    name<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="25"></td><td><pre>    owner<span class="token punctuation">:</span> <span class="token class-name">UserId</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="27"></td><td><pre></pre></td></tr><tr><td data-num="28"></td><td><pre><span class="token comment">// 定义聊天室中可能发生的事件</span></pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token attribute attr-name">#[derive(Debug)]</span></pre></td></tr><tr><td data-num="30"></td><td><pre><span class="token keyword">enum</span> <span class="token type-definition class-name">Event</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="31"></td><td><pre>    <span class="token class-name">Join</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">UserId</span><span class="token punctuation">,</span> <span class="token class-name">TopicId</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="32"></td><td><pre>    <span class="token class-name">Leave</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">UserId</span><span class="token punctuation">,</span> <span class="token class-name">TopicId</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="33"></td><td><pre>    <span class="token class-name">Message</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">UserId</span><span class="token punctuation">,</span> <span class="token class-name">TopicId</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="34"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="35"></td><td><pre></pre></td></tr><tr><td data-num="36"></td><td><pre><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="37"></td><td><pre>    <span class="token keyword">let</span> alice <span class="token operator">=</span> <span class="token class-name">User</span> <span class="token punctuation">&#123;</span> id<span class="token punctuation">:</span> <span class="token class-name">UserId</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> name<span class="token punctuation">:</span> <span class="token string">"Alice"</span><span class="token punctuation">.</span><span class="token function">into</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> gender<span class="token punctuation">:</span> <span class="token class-name">Gender</span><span class="token punctuation">::</span><span class="token class-name">Female</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="38"></td><td><pre>    <span class="token keyword">let</span> bob <span class="token operator">=</span> <span class="token class-name">User</span> <span class="token punctuation">&#123;</span> id<span class="token punctuation">:</span> <span class="token class-name">UserId</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> name<span class="token punctuation">:</span> <span class="token string">"Bob"</span><span class="token punctuation">.</span><span class="token function">into</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> gender<span class="token punctuation">:</span> <span class="token class-name">Gender</span><span class="token punctuation">::</span><span class="token class-name">Male</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="39"></td><td><pre></pre></td></tr><tr><td data-num="40"></td><td><pre>    <span class="token keyword">let</span> topic <span class="token operator">=</span> <span class="token class-name">Topic</span> <span class="token punctuation">&#123;</span> id<span class="token punctuation">:</span> <span class="token class-name">TopicId</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> name<span class="token punctuation">:</span> <span class="token string">"rust"</span><span class="token punctuation">.</span><span class="token function">into</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> owner<span class="token punctuation">:</span> <span class="token class-name">UserId</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="41"></td><td><pre>    <span class="token keyword">let</span> event1 <span class="token operator">=</span> <span class="token class-name">Event</span><span class="token punctuation">::</span><span class="token class-name">Join</span><span class="token punctuation">(</span><span class="token punctuation">(</span>alice<span class="token punctuation">.</span>id<span class="token punctuation">,</span> topic<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="42"></td><td><pre>    <span class="token keyword">let</span> event2 <span class="token operator">=</span> <span class="token class-name">Event</span><span class="token punctuation">::</span><span class="token class-name">Join</span><span class="token punctuation">(</span><span class="token punctuation">(</span>bob<span class="token punctuation">.</span>id<span class="token punctuation">,</span> topic<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="43"></td><td><pre>    <span class="token keyword">let</span> event3 <span class="token operator">=</span> <span class="token class-name">Event</span><span class="token punctuation">::</span><span class="token class-name">Message</span><span class="token punctuation">(</span><span class="token punctuation">(</span>alice<span class="token punctuation">.</span>id<span class="token punctuation">,</span> topic<span class="token punctuation">.</span>id<span class="token punctuation">,</span> <span class="token string">"Hello world!"</span><span class="token punctuation">.</span><span class="token function">into</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="44"></td><td><pre></pre></td></tr><tr><td data-num="45"></td><td><pre>    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"event1: &#123;:?&#125;, event2: &#123;:?&#125;, event3: &#123;:?&#125;"</span><span class="token punctuation">,</span> event1<span class="token punctuation">,</span> event2<span class="token punctuation">,</span> event3<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="46"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><blockquote><p>说明<br>1、Gender: 一个枚举类型，在 Rust 下，使用 enum 可以定义类似 C 的枚举类型</p><p>2、UserId/TopicId: struct 的特殊形式，称为元组结构体。它的域都是匿名的，可以用索引访问，适用于简单的结构体</p><p>3、User/Topic: 标准的结构体，可以把任何类型组合在结构体里使用</p><p>4、Event: 标准的标签联合体，它定义了三种事件：Join、Leave、Message。每种事件都有自己的数据结构</p></blockquote><h2 id="控制语句"><a class="anchor" href="#控制语句">#</a> 控制语句</h2><blockquote><p>条件语句</p></blockquote><figure class="highlight rust"><figcaption data-lang="rust"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">fn</span> <span class="token function-definition function">main</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token keyword">let</span> age<span class="token punctuation">:</span> <span class="token keyword">i32</span> <span class="token operator">=</span> <span class="token number">30_i32</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token keyword">if</span> age <span class="token operator">&lt;</span> <span class="token number">18</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"teenager"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>        <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"adult"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="10"></td><td><pre></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><blockquote><p>循环语句<br>Rust 支持三种循环，分别是死循环 loop，条件循环 while，以及对迭代器的循环 for<br>循环可以使用 break 提前终止，或者使用 continue 跳到下一轮循环<br>和 C 语言类似，循环支持打标签（不推荐使用）</p></blockquote><figure class="highlight rust"><figcaption data-lang="rust"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">fn</span> <span class="token function-definition function">main</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    <span class="token keyword">let</span> <span class="token keyword">mut</span> n<span class="token punctuation">:</span> <span class="token keyword">i32</span> <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token keyword">loop</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>        <span class="token keyword">if</span> n <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>            <span class="token keyword">break</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>        <span class="token macro property">print!</span><span class="token punctuation">(</span><span class="token string">"loop "</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>        n <span class="token operator">=</span> n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre></pre></td></tr><tr><td data-num="13"></td><td><pre>    </pre></td></tr><tr><td data-num="14"></td><td><pre>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token number">0</span><span class="token punctuation">..</span><span class="token number">5</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>        <span class="token macro property">print!</span><span class="token punctuation">(</span><span class="token string">"&#123;&#125; "</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre></pre></td></tr><tr><td data-num="19"></td><td><pre>    n <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>    <span class="token keyword">while</span> n <span class="token operator">!=</span> <span class="token number">0</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>        <span class="token macro property">print!</span><span class="token punctuation">(</span><span class="token string">"&#123;&#125; "</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>        n <span class="token operator">=</span> n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="23"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="24"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><blockquote><p>模式匹配<br>match 关键字用于模式匹配，它可以匹配 struct/enum 中部分或者全部内容<br>可以直接对 enum 内层的数据进行匹配并赋值<br>可以使用 _ 符号进行缺省匹配</p></blockquote><figure class="highlight rust"><figcaption data-lang="rust"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// 下面使用了 Debug 派生宏 用于简化 struct/enum 输出</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token attribute attr-name">#[derive(Debug)]</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">struct</span> <span class="token type-definition class-name">CountryName</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token attribute attr-name">#[derive(Debug)]</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">struct</span> <span class="token type-definition class-name">CountryRegion</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token attribute attr-name">#[derive(Debug)]</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">struct</span> <span class="token type-definition class-name">OtherInfo</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    population<span class="token punctuation">:</span> <span class="token keyword">f32</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token attribute attr-name">#[derive(Debug)]</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">enum</span> <span class="token type-definition class-name">Country</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token class-name">China</span><span class="token punctuation">(</span><span class="token class-name">CountryName</span><span class="token punctuation">,</span> <span class="token class-name">CountryRegion</span><span class="token punctuation">,</span> <span class="token class-name">OtherInfo</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token class-name">Japan</span><span class="token punctuation">(</span><span class="token class-name">CountryName</span><span class="token punctuation">,</span> <span class="token class-name">CountryRegion</span><span class="token punctuation">,</span> <span class="token class-name">OtherInfo</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token class-name">Canada</span><span class="token punctuation">(</span><span class="token class-name">CountryName</span><span class="token punctuation">,</span> <span class="token class-name">CountryRegion</span><span class="token punctuation">,</span> <span class="token class-name">OtherInfo</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="20"></td><td><pre></pre></td></tr><tr><td data-num="21"></td><td><pre></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token keyword">fn</span> <span class="token function-definition function">print_country_info</span><span class="token punctuation">(</span>country<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token class-name">Country</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="23"></td><td><pre>    <span class="token keyword">match</span> country<span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>        <span class="token class-name">Country</span><span class="token punctuation">::</span><span class="token class-name">China</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> region<span class="token punctuation">,</span> other_info<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="25"></td><td><pre>            <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"country name: &#123;:?&#125;, country region: &#123;:?&#125;, other info: &#123;:?&#125;"</span><span class="token punctuation">,</span> name<span class="token punctuation">,</span> region<span class="token punctuation">,</span> other_info<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="26"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="27"></td><td><pre>        <span class="token class-name">Country</span><span class="token punctuation">::</span><span class="token class-name">Japan</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> region<span class="token punctuation">,</span> _<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="28"></td><td><pre>            <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"country name: &#123;:?&#125;, country region: &#123;:?&#125;"</span><span class="token punctuation">,</span> name<span class="token punctuation">,</span> region<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="29"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="30"></td><td><pre>        <span class="token class-name">Country</span><span class="token punctuation">::</span><span class="token class-name">Canada</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> _<span class="token punctuation">,</span> _<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="31"></td><td><pre>            <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"country name: &#123;:?&#125;"</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="32"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="33"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="34"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="35"></td><td><pre></pre></td></tr><tr><td data-num="36"></td><td><pre><span class="token keyword">fn</span> <span class="token function-definition function">main</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="37"></td><td><pre></pre></td></tr><tr><td data-num="38"></td><td><pre>    <span class="token keyword">let</span> china <span class="token operator">=</span> <span class="token class-name">Country</span><span class="token punctuation">::</span><span class="token class-name">China</span><span class="token punctuation">(</span><span class="token class-name">CountryName</span><span class="token punctuation">(</span><span class="token string">"中国"</span><span class="token punctuation">.</span><span class="token function">into</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">CountryRegion</span><span class="token punctuation">(</span><span class="token string">"亚洲"</span><span class="token punctuation">.</span><span class="token function">into</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">OtherInfo</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="39"></td><td><pre>        population<span class="token punctuation">:</span> <span class="token number">14.13_f32</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="40"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="41"></td><td><pre></pre></td></tr><tr><td data-num="42"></td><td><pre>    <span class="token keyword">let</span> japan <span class="token operator">=</span> <span class="token class-name">Country</span><span class="token punctuation">::</span><span class="token class-name">Japan</span><span class="token punctuation">(</span><span class="token class-name">CountryName</span><span class="token punctuation">(</span><span class="token string">"日本"</span><span class="token punctuation">.</span><span class="token function">into</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">CountryRegion</span><span class="token punctuation">(</span><span class="token string">"亚洲"</span><span class="token punctuation">.</span><span class="token function">into</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">OtherInfo</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="43"></td><td><pre>        population<span class="token punctuation">:</span> <span class="token number">1.26_f32</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="44"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="45"></td><td><pre></pre></td></tr><tr><td data-num="46"></td><td><pre>    <span class="token keyword">let</span> canada <span class="token operator">=</span> <span class="token class-name">Country</span><span class="token punctuation">::</span><span class="token class-name">Canada</span><span class="token punctuation">(</span><span class="token class-name">CountryName</span><span class="token punctuation">(</span><span class="token string">"加拿大"</span><span class="token punctuation">.</span><span class="token function">into</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">CountryRegion</span><span class="token punctuation">(</span><span class="token string">"北美洲"</span><span class="token punctuation">.</span><span class="token function">into</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">OtherInfo</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="47"></td><td><pre>        population<span class="token punctuation">:</span> <span class="token number">0.3820_f32</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="48"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="49"></td><td><pre></pre></td></tr><tr><td data-num="50"></td><td><pre>    <span class="token comment">// 输出：country name: CountryName ("中国"), country region: CountryRegion ("亚洲"), other info: OtherInfo &#123; population: 14.13 &#125;</span></pre></td></tr><tr><td data-num="51"></td><td><pre>    <span class="token function">print_country_info</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>china<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="52"></td><td><pre></pre></td></tr><tr><td data-num="53"></td><td><pre>    <span class="token comment">// 输出：country name: CountryName ("日本"), country region: CountryRegion ("亚洲")</span></pre></td></tr><tr><td data-num="54"></td><td><pre>    <span class="token function">print_country_info</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>japan<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="55"></td><td><pre></pre></td></tr><tr><td data-num="56"></td><td><pre>    <span class="token comment">// 输出：country name: CountryName ("加拿大")</span></pre></td></tr><tr><td data-num="57"></td><td><pre>    <span class="token function">print_country_info</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>canada<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="58"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h2 id="错误处理"><a class="anchor" href="#错误处理">#</a> 错误处理</h2><blockquote><p>Rust 没有沿用 C++/Java 等语言使用的异常处理方式，而是借鉴 Haskell，把错误封装在 Result&lt;T, E&gt; 类型中<br>同时提供了？操作符来传播错误，Result&lt;T, E&gt; 类型是一个泛型数据结构，T 代表成功执行返回的结果类型，E 代表错误类型<br>？操作符只能用在返回类型为 Result&lt;T, E&gt; 和 Option&lt;T&gt; 的函数当中</p></blockquote><figure class="highlight rust"><figcaption data-lang="rust"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// 在 Cargo.toml 配置文件中的 dependencies 下添加如下依赖</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment">// reqwest = &#123;version = "0.11.0", features = ["blocking"] &#125;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">// html2md = "0.2.0"</span></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span></span>fs<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token comment">//main 函数现在返回一个 Result</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">Box</span><span class="token operator">&lt;</span><span class="token keyword">dyn</span> <span class="token namespace">std<span class="token punctuation">::</span>error<span class="token punctuation">::</span></span><span class="token class-name">Error</span><span class="token operator">>></span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token keyword">let</span> url <span class="token operator">=</span> <span class="token string">"https://www.rust-lang.org/"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token keyword">let</span> output <span class="token operator">=</span> <span class="token string">"rust.md"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Fetching url: &#123;&#125;"</span><span class="token punctuation">,</span> url<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token keyword">let</span> body <span class="token operator">=</span> <span class="token namespace">reqwest<span class="token punctuation">::</span>blocking<span class="token punctuation">::</span></span><span class="token function">get</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre>    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Converting html to markdown..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token keyword">let</span> md <span class="token operator">=</span> <span class="token namespace">html2md<span class="token punctuation">::</span></span><span class="token function">parse_html</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>body<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token namespace">fs<span class="token punctuation">::</span></span><span class="token function">write</span><span class="token punctuation">(</span>output<span class="token punctuation">,</span> md<span class="token punctuation">.</span><span class="token function">as_bytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">"Converted markdown has been saved in &#123;&#125;."</span><span class="token punctuation">,</span> output<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre></pre></td></tr><tr><td data-num="20"></td><td><pre>    <span class="token class-name">Ok</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><div class="tags"><a href="/tags/Rust/" rel="tag"><i class="ic i-tag"></i> Rust</a></div></div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-calendar-check"></i> </span><span class="text">更新于</span> <time title="修改时间：2023-05-31 18:45:21" itemprop="dateModified" datetime="2023-05-31T18:45:21+08:00">2023-05-31</time> </span><span id="posts/65e30da8/" class="item leancloud_visitors" data-flag-title="Rust 学习 - 基本语法" title="阅读次数"><span class="icon"><i class="ic i-eye"></i> </span><span class="text">阅读次数</span> <span class="leancloud-visitors-count"></span> <span class="text">次</span></span></div><div id="copyright"><ul><li class="author"><strong>本文作者： </strong>unistart <i class="ic i-at"><em>@</em></i>UniStart's Blog</li><li class="link"><strong>本文链接：</strong> <a href="https://unistart2.github.io/posts/65e30da8/" title="Rust 学习 - 基本语法">https://unistart2.github.io/posts/65e30da8/</a></li><li class="license"><strong>版权声明： </strong>本站所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> 许可协议。转载请注明出处！</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"></div><div class="item right"><a href="/posts/f53ec71f/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;api.hanximeng.com&#x2F;ranimg&#x2F;api.php?604070" title="WebAssembly - 初探"><span class="type">下一篇</span> <span class="category"><i class="ic i-flag"></i> WebAssembly</span><h3>WebAssembly - 初探</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="文章目录"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%98%E9%87%8F%E5%92%8C%E5%87%BD%E6%95%B0"><span class="toc-number">1.</span> <span class="toc-text">变量和函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84"><span class="toc-number">2.</span> <span class="toc-text">数据结构</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8E%A7%E5%88%B6%E8%AF%AD%E5%8F%A5"><span class="toc-number">3.</span> <span class="toc-text">控制语句</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86"><span class="toc-number">4.</span> <span class="toc-text">错误处理</span></a></li></ol></div><div class="related panel pjax" data-title="系列文章"><ul><li class="active"><a href="/posts/65e30da8/" rel="bookmark" title="Rust学习-基本语法">Rust学习-基本语法</a></li><li><a href="/posts/5ff881ce/" rel="bookmark" title="Rust学习-所有权">Rust学习-所有权</a></li><li><a href="/posts/45ddda31/" rel="bookmark" title="Rust学习-处理整形溢出">Rust学习-处理整形溢出</a></li></ul></div><div class="overview panel" data-title="站点概览"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="unistart" data-src="/images/avatar.jpg"><p class="name" itemprop="name">unistart</p><div class="description" itemprop="description">个人博客</div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">27</span> <span class="name">文章</span></a></div><div class="item categories"><a href="/categories/"><span class="count">12</span> <span class="name">分类</span></a></div><div class="item tags"><a href="/tags/"><span class="count">17</span> <span class="name">标签</span></a></div></nav><div class="social"><span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL3VuaXN0YXJ0Mg==" title="https:&#x2F;&#x2F;github.com&#x2F;unistart2"><i class="ic i-github"></i></span> <span class="exturl item email" data-url="bWFpbHRvOjI2MDQyNDk2NDlAcXEuY29t" title="mailto:2604249649@qq.com"><i class="ic i-envelope"></i></span></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>首页</a></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-feather"></i>文章</a><ul class="submenu"><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>归档</a></li><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>分类</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>标签</a></li></ul></li><li class="item"><a href="/friends/" rel="section"><i class="ic i-heart"></i>友達</a></li><li class="item"><a href="/links/" rel="section"><i class="ic i-magic"></i>链接</a></li></ul></div></div></div><ul id="quick"><li class="prev pjax"></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>随机文章</h2><ul><li class="item"><div class="breadcrumb"><a href="/categories/Rails/" title="分类于 Rails">Rails</a></div><span><a href="/posts/35a6dd5d/" title="Rails - 编写测试">Rails - 编写测试</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Linux/" title="分类于 Linux">Linux</a></div><span><a href="/posts/b702c88f/" title="Linux学习 - 快速上手几个Linux命令">Linux学习 - 快速上手几个Linux命令</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Ruby/" title="分类于 Ruby">Ruby</a></div><span><a href="/posts/f112a2c2/" title="Ruby学习-基础知识">Ruby学习-基础知识</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Rust/" title="分类于 Rust">Rust</a></div><span><a href="/posts/65e30da8/" title="Rust学习-基本语法">Rust学习-基本语法</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/MySQL/" title="分类于 MySQL">MySQL</a></div><span><a href="/posts/fc4990cc/" title="MySQL8 安装">MySQL8 安装</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Rails/" title="分类于 Rails">Rails</a></div><span><a href="/posts/2fb1a3c3/" title="Rails学习-迁移方法">Rails学习-迁移方法</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Rails/" title="分类于 Rails">Rails</a></div><span><a href="/posts/e552de99/" title="Rails学习-cache缓存">Rails学习-cache缓存</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/WebGL/" title="分类于 WebGL">WebGL</a></div><span><a href="/posts/cd788354/" title="WebGL学习（附录）">WebGL学习（附录）</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Rust/" title="分类于 Rust">Rust</a></div><span><a href="/posts/5ff881ce/" title="Rust学习-所有权">Rust学习-所有权</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Github/" title="分类于 Github">Github</a></div><span><a href="/posts/c0d30721/" title="多个Github Pages设置">多个Github Pages设置</a></span></li></ul></div><div><h2>最新评论</h2><ul class="leancloud-recent-comment"></ul></div></div><div class="status"><div class="copyright">&copy; 2022 – <span itemprop="copyrightYear">2024</span> <span class="with-love"><i class="ic i-sakura rotate"></i> </span><span class="author" itemprop="copyrightHolder">unistart @ UniStart</span></div><div class="count"><span class="post-meta-item-icon"><i class="ic i-chart-area"></i> </span><span title="站点总字数">107k 字</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="ic i-coffee"></i> </span><span title="站点阅读时长">1:38</span></div><div class="powered-by">基于 <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"posts/65e30da8/",favicon:{show:"（●´3｀●）やれやれだぜ",hide:"(´Д｀)大変だ！"},search:{placeholder:"文章搜索",empty:"关于 「 ${query} 」，什么也没搜到",stats:"${time} ms 内找到 ${hits} 条结果"},valine:!0,fancybox:!0,copyright:'复制成功，转载请遵守 <i class="ic i-creative-commons"></i>BY-NC-SA 协议。',ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="//fastly.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script><script src="/js/app.js?v=0.2.5"></script></body></html><!-- rebuild by hrmmi -->